<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    <title>Data Visualization</title>

    <!-- Bootstrap -->
    <link href="css/bootstrap.min.css" rel="stylesheet">
    <link href="css/myStyles.css" rel="stylesheet">
    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
  </head>


<!--color:#6288A5     #326891-->


  <body>

    <nav class="navbar navbar-default navbar-fixed-top">


<p class="navbar-text" id= "centered">The New York Times</p>
<button type="button" class="btn btn-default navbar-btn btn-sm">SUBSCRIBE NOW</button>
        </nav>

    <link rel="stylesheet" type="text/css" href="http://cdn.datatables.net/1.10.11/css/jquery.dataTables.css">
<div id="intro" class="row">
  <div class="text col-xs-12 col-md-5">
<p id="the-world"><b>THE WORLD</b></p>


    <h1>Refugees: From Home to United States of America</h1>

    <p>The refugee crisis has been on the forefront of the American mind since the Syiran conflict once again highlighted
      the difficulties of refugees worldwide. </p>
    <p> According to the U.S. Department of State, a refugee is "someone who has fled from his or her home country
    and cannot return because he or she has a well-founded fear of
    persecution based on religion, race, nationality, political opinion or membership in a particular social group."</p>
    <p> The number of refugees entering the U.S. is less than it was in 1990, but arrivals have been on the rise in recent years (see graph to the right).</p>
  </div>

  <div class= "col-xs-12 col-md-7">
      <div id="chart3"></div>
  </div>
</div> <!--end of the row-->


<div class="row">
<!--or get rid of the bootstrap stuff to make it go back to being centered-->
<!--maybe try negative padding on the map-->
<div id= "text-spacing" class="col-sm-12 col-md-3 col-md-push-8">
  <h3> Where in the U.S. are the refugees settling?</h3>
  <p>Texas took in the largest number of refugees in 2014, followed by California, New York and Michigan.</p>
  <p> That may be changing soon. According to Quartz, Texas governor Greg Abbott is now refusing to accept Syrian refugees.
  <p>Not a single refugee has settled in Montana or Wyoming. Other unpopular states for refugee settlement
    include Mississippi and Arkansas, which have 7 each, and Hawaii, which only has 2 refugees.</p>
    <p> Roll over the map to see exactly how many refugees have settled in each state.</p>
</p>
</div>


  <div id="map1-spacing">
  <div id="map1" class="col-sm-12 col-md-8 col-md-pull-3 "></div> </div>

</div>
<div id="info">
<p><h3> Who are these refugees?</h3> The following pie graphs give a demographic breakdown of the refugees entering the U.S. in fiscal year
  2013. Slightly more men than women entered the U.S. The majority were either single or married, and in the age group 20-44 (or, typical adults). </p>
</div>

<div id="pies" class="row">
  <div id="pie1" class="col-sm-12 col-md-4" style="min-width: 310px; height: 400px; max-width: 600px; margin: 0 auto"></div>
  <div id="pie2" class="col-sm-12 col-md-4" style="min-width: 310px; height: 400px; max-width: 600px; margin: 0 auto"></div>
  <div id="pie3" class="col-sm-12 col-md-4" style="min-width: 310px; height: 400px; max-width: 600px; margin: 0 auto"></div>
</div>

<div id="info">
<p><h3> Where are the refugees coming from?</h3> Find out which countries have sent the most refugees to the U.S.
  between 2010 and 2013. You can also search by country to find out how refugee exit from that country
has changed over the years.</p>
</div>

<div class=container>
<table id="example" class="row-border hover" cellspacing="0" width="100%"> <!--display-->
<!--responsiveness should work with 4 columns- years 2010-2013-->
        <thead>
            <tr>
                <th>Country of Nationality</th>

                <th>2010</th>
                <th>2011</th>
                <th>2012</th>
                <th>2013</th>

            </tr>
        </thead>
        <tfoot>
            <tr>
              <th>Country of Nationality</th>

              <th>2010</th>
              <th>2011</th>
              <th>2012</th>
              <th>2013</th>

            </tr>
        </tfoot>
    </table>

</div>





    <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>

    <!-- Include all compiled plugins (below), or include individual files as needed -->

    <!-- problem: no js folder so where is this -->
    <script src="js/bootstrap.min.js"></script>

    <script src="http://code.highcharts.com/highcharts.js"></script>
    <!--<script src="http://code.highcharts.com/maps/highmaps.js"></script>-->

    <script src="http://code.highcharts.com/maps/modules/map.js"></script>
    <script src="http://code.highcharts.com/mapdata/countries/us/us-all.js"></script>
    <script src="http://cdn.datatables.net/1.10.11/js/jquery.dataTables.min.js"></script>
    <script>
    $(document).ready(function(){
      /*buildChart1();*/
      buildMap1();
      /*buildChart2();*/
      buildPie1();
      buildPie2();
      buildPie3();
      buildChart3();
      $('#example').DataTable( {

          "ajax": 'json/convertcsvDataTable.json'



      } );

    //var theWindowWidth = $(window).width();
      //console.log(theWindowWidth);-->
    //  if (theWindowWidth < 800){//call another function that creates another chart (dont need a new json file or anything like that)
//}






    });

function buildChart3(){
      $('#chart3').highcharts({
        title: {
            text: 'Refugee Arrivals: Fiscal Years 1990 to 2013',
            x: -20 //center
        },
        subtitle: {
            text: 'Source: 2013 Yearbook of Immigration Statistics',
            x: -20
        },
        plotOptions:{
          line:{
            color:'#326891'
          }
        },
        xAxis: {
            categories: ['1990', '1991', '1992','1993','1994','1995',
              '1996','1997','1998','1999','2000','2001','2002','2003','2004','2005','2006','2007',
            '2008','2009','2010','2011','2012','2013']
        },
        yAxis: {
            title: {
                text: 'Number of Arrivals'
            },
            plotLines: [{
                value: 0,
                width: 1,
                color: '#808080'
            }]
        },
        tooltip: {
            valueSuffix: ''
        },
        chart: {
          style: {
            fontFamily: 'Georgia',

          }



    },
        legend: {
            layout: 'vertical',
            align: 'right',
            verticalAlign: 'middle',
            borderWidth: 0
        },
        series: [{
            name: 'U.S.',
            data: [122066, 113389, 115548, 114181, 111680, 98973, 75421, 69653, 76712, 85285, 72143, 68925, 26788, 28286, 52840,
            53738, 41094, 48218, 60107, 74602, 73293, 56384, 58179, 69909]

        }]
    });
    }

    function buildMap1(){
      //need to create a new json file with this info
      $.getJSON("json/convertcsv.json", function (data) {

        // Make codes uppercase to match the map data
        $.each(data, function () {
            this.code = this.code.toUpperCase();
        });
        console.log(data);
        // Instanciate the map
        $('#map1').highcharts('Map', {

            chart : {
                borderWidth : 0, //1
                /*height:600,
                width:800*/
            },

            title : {
                text : '', /*Refugee Settlement in the U.S. Fiscal Year 2014*/
                verticalAlign: "middle",
                align: "left",

            },

            legend: {
                layout: 'vertical',
                borderWidth: 0,
                backgroundColor: 'rgba(255,255,255,0.85)',
                floating: true,
                verticalAlign: 'middle',
                align:'left',
                x:-20,
                width:10,
                enabled:false
                /*y: 38//25*/
            },

            mapNavigation: {
                enabled: false,
                enableButtons:false
            },




            colorAxis: {
                min: 1,
                type: 'logarithmic',  /*these 5 lines change the color of the map */
                minColor: '#A0D9FF', /*eeeeff, 000022, efeff, 4444ff, 000022  */
                maxColor: '#0F487F', /*90bee1, 2e3d48, 0091ff, 326891, 2e3d48*/
                stops: [
                    [0, '#A0D9FF'], /*5891C8*/
                    [0.67, '#82B3DE'], /*346DA4*/
                    [1, '#0F487F']   /*214661*/
                ]
            },

            series : [{
                animation: {
                    duration: 1000
                },
                data : data,
                mapData: Highcharts.maps['countries/us/us-all'],
                joinBy: ['postal-code', 'code'],
                dataLabels: {
                    enabled: true,
                    color: '#FFFFFF',
                    format: '{point.code}'
                },
                name: 'Number of Refugees',
                tooltip: {
                    pointFormat: '{point.code}: {point.value}'
                }
            }]
        });
    });
    }



    function buildPie1(){
      Highcharts.getOptions().plotOptions.pie.colors = (function () {
              var colors = [],
                  base = Highcharts.getOptions().colors[0],
                  i;

              for (i = 0; i < 10; i += 1) {
                  // Start out with a darkened base color (negative brighten), and end
                  // up with a much brighter color
                  colors.push(Highcharts.Color(base).brighten((i - 2) / 7).get());
              }
              return colors;
          }());






      $('#pie1').highcharts({
            chart: {
                plotBackgroundColor: null,
                plotBorderWidth: null,
                plotShadow: false,
                type: 'pie',
                style: {
                  fontFamily: 'Georgia',
                }
            },
            title: {
                text: 'Gender'
            },
            tooltip: {
                pointFormat: '{series.name}: <b>{point.percentage:.1f}%</b>'
            },
            plotOptions: {
                pie: {
                    allowPointSelect: true,
                    cursor: 'pointer',
                    dataLabels: {
                        enabled: false,
                        style: {
                        color: (Highcharts.theme && Highcharts.theme.contrastTextColor) || 'black'
                    }
                    },
                    showInLegend: true
                }
            },
            series: [{
                name: 'Gender',
                colorByPoint: true,
                data: [{
                    name: 'Men',
                    y: 54.06
                }, {
                    name: 'Women',
                    y: 45.94,
                    sliced: true,
                    selected: true
                }]
            }]
        });
    }
    function buildPie2(){
      $('#pie2').highcharts({
            chart: {
                plotBackgroundColor: null,
                plotBorderWidth: null,
                plotShadow: false,
                type: 'pie',
                style: {
                  fontFamily: 'Georgia',
                }
            },
            title: {
                text: 'Marital Status'
            },
            tooltip: {
                pointFormat: '{series.name}: <b>{point.percentage:.1f}%</b>'
            },
            plotOptions: {
                pie: {
                    allowPointSelect: true,
                    cursor: 'pointer',
                    dataLabels: {
                        enabled: false
                    },
                    showInLegend: true
                }
            },
            series: [{
                name: 'Status',
                colorByPoint: true,
                data: [{
                    name: 'Single',
                    y: 56.35
                }, {
                    name: 'Married',
                    y: 38.32,
                    sliced: true,
                    selected: true
                }, {
                    name: 'Widowed',
                    y: 2.77
                }, {
                    name: 'Divorced/Separated',
                    y: 2.52
                }, {
                    name: 'Unknown',
                    y: 0.05
                }]
            }]
        });
    }


    function buildPie3(){
      $('#pie3').highcharts({
            chart: {
                plotBackgroundColor: null,
                plotBorderWidth: null,
                plotShadow: false,
                type: 'pie',
                style: {
                  fontFamily: 'Georgia',
                }
            },
            title: {
                text: 'Age'
            },
            tooltip: {
                pointFormat: '{series.name}: <b>{point.percentage:.1f}%</b>'
            },
            plotOptions: {
                pie: {
                    allowPointSelect: true,
                    cursor: 'pointer',
                    dataLabels: {
                        enabled: false
                    },
                    showInLegend: true
                }
            },
            series: [{
                name: 'Age',
                colorByPoint: true,
                data: [{
                    name: 'Less than 15',
                    y: 28.56
                }, {
                    name: '15-19',
                    y: 9.08,
                    sliced: true,
                    selected: true
                }, {
                    name: '20-44',
                    y: 46.63
                }, {
                    name: '45-74',
                    y: 14.82
                }, {
                    name: '75+',
                    y: 0.90

                }]
            }]
        });
    }





          </script>
  </body>
</html>
